{"version":3,"file":"index.js","mappings":"CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,GAAIH,GACe,iBAAZC,QACdA,QAAmB,UAAID,IAEvBD,EAAgB,UAAIC,GACrB,CATD,CASGK,MAAM,I,mBCRT,IAAIC,EAAsB,CCA1BA,EAAwB,CAACL,EAASM,KACjC,IAAI,IAAIC,KAAOD,EACXD,EAAoBG,EAAEF,EAAYC,KAASF,EAAoBG,EAAER,EAASO,IAC5EE,OAAOC,eAAeV,EAASO,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDF,EAAwB,CAACQ,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,I,4BCAlF,IAAII,EAAY,CAAC,EACjB,MAAMC,EAAiB,cAEvB,IAAIC,EAAY,CAEdC,QAAS,IAETC,SAAU,IAEVC,MAAO,MAEPC,OAAQ,MAERC,YAAa,GAEbC,OAAQ,kBAERC,QAAS,OAETC,UAAW,MAEXC,SAAU,UAIZX,EAAUY,aAAgBC,IACxB,IAAIC,EAAKd,EAAUe,cAAcF,GACG,OAAhCG,SAASC,eAAeH,KAC1BA,EAAKd,EAAUe,cAAcF,GAC/B,EAGFb,EAAUkB,gBAAkB,KAC1B,IAAIJ,EAAKb,EAC2B,OAAhCe,SAASC,eAAeH,IAE1BK,gBAAe,KACbH,SAASI,KAAKC,YAAYL,SAASC,eAAeH,GAAI,GAE1D,EA2BFd,EAAUe,cAAiBF,IACzB,IAAIS,EAAW,CAAC,EACZC,EAAWV,EAAQW,QAKrBF,EAHAT,EAAQX,WAC8C,oBAAtDX,OAAOM,UAAU4B,SAAS1B,KAAKc,EAAQX,WAE5BX,OAAOmC,OAAO,CAAC,EAAGxB,EAAWW,EAAQX,WAErCA,EAGb,IAAIY,EAAKb,EAC2B,OAAhCe,SAASC,eAAeH,IAC1BE,SAASI,KAAKC,YAAYL,SAASC,eAAeH,IAGpD,IAAIa,EAASX,SAASY,cAAc,UACpCD,EAAOE,MAAQP,EAASnB,QACxBwB,EAAOG,OAASR,EAASlB,SACzB,IAAI2B,EAAMJ,EAAOK,WAAW,MAO5B,GANAD,EAAIE,QAAUX,EAASf,YAAc2B,KAAKC,GAAM,KAChDJ,EAAIK,KAAOd,EAASd,OACpBuB,EAAIM,UAAYf,EAASb,QACzBsB,EAAIO,UAAY,SAChBP,EAAIQ,aAAe,SAGjB1B,EAAQW,SAC4C,mBAApDjC,OAAOM,UAAU4B,SAAS1B,KAAKc,EAAQW,SAEvC,IAAK,IAAIgB,EAAI,EAAGA,EAAIjB,EAASkB,OAAQD,IAAK,CACxC,MAAME,EAAUnB,EAASiB,GACzBT,EAAIY,SAASD,EAASf,EAAOE,MAAQ,EAAGF,EAAOG,OAAS,IAAU,GAAJU,EAChE,CAGF,IAAII,EAAM5B,SAASY,cAAc,OAiBjC,OAhBAgB,EAAI9B,GAAKA,EACT8B,EAAIC,UAAY,cAChBD,EAAIE,MAAMC,cAAgB,OAC1BH,EAAIE,MAAME,IAAM1B,EAASjB,MACzBuC,EAAIE,MAAMG,KAAO3B,EAAShB,OAC1BsC,EAAIE,MAAMI,QAAU5B,EAASZ,UAC7BkC,EAAIE,MAAMK,SAAW,QACrBP,EAAIE,MAAMM,OAAS9B,EAASX,SAC5BiC,EAAIE,MAAMjB,MAAQ,OAClBe,EAAIE,MAAMhB,OAAS,OACnBc,EAAIE,MAAMO,WAAa,OAAS1B,EAAO2B,YAAc,oBACrDtC,SAASI,KAAKmC,YAAYX,GAE1BzB,gBAAe,KACbnB,EAAUwD,iBAAiBZ,EAAK/B,EAAQ,IAEnCC,CAAE,EAEXd,EAAUwD,iBAAmB,CAACC,EAAc5C,KAE1C,MAAM6C,EAAa1C,SAAS2C,cAAc,QA+B1C3D,EAAU4D,SAAW,IAAIC,kBA1BR,SAAUC,EAAeC,GACxC,IAAK,IAAIC,KAAYF,EASfE,EAASC,SAAWR,IACtBO,EAASC,OAAOC,SAChBlE,EAAUe,cAAcF,GACxBkD,EAASI,cAGTH,EAASI,aAAa3B,QACtBuB,EAASI,aAAa,KAAOX,IAG7BzD,EAAUe,cAAcF,GAExBkD,EAASI,aAGf,IAEAnE,EAAU4D,SAASS,QAAQX,EA9BZ,CAAEY,YAAY,EAAMC,WAAW,EAAMC,SAAS,GA8Bf,EAGhD,U","sources":["webpack://watermark/webpack/universalModuleDefinition","webpack://watermark/webpack/bootstrap","webpack://watermark/webpack/runtime/define property getters","webpack://watermark/webpack/runtime/hasOwnProperty shorthand","webpack://watermark/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"watermark\"] = factory();\n\telse\n\t\troot[\"watermark\"] = factory();\n})(this, () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var Watermark = {};\r\nconst WaterMarkDomId = \"zxWatermark\";\r\n// 参数配置\r\nvar w_options = {\r\n  // 水印块宽度\r\n  w_width: 240,\r\n  // 水印块高度\r\n  w_height: 140,\r\n  // 水印区域top距离\r\n  w_top: \"0px\",\r\n  // 水印区域left距离\r\n  w_left: \"0px\",\r\n  // 旋转角度\r\n  w_rotateDeg: 25,\r\n  // 字体大小、风格\r\n  w_font: \"bold 48px serif\",\r\n  // 字体颜色 rgb | 16进制字符串\r\n  w_color: \"#666\",\r\n  // 透明度\r\n  w_opacity: \"0.1\",\r\n  // 层级\r\n  w_zIndex: \"100000\",\r\n};\r\n\r\n// 添加水印生成一个遮罩\r\nWatermark.setWaterMark = (options) => {\r\n  let id = Watermark.loadWatermark(options);\r\n  if (document.getElementById(id) === null) {\r\n    id = Watermark.loadWatermark(options);\r\n  }\r\n};\r\n// 移除水印\r\nWatermark.removeWatermark = () => {\r\n  let id = WaterMarkDomId;\r\n  if (document.getElementById(id) !== null) {\r\n    // 移除\r\n    queueMicrotask(() => {\r\n      document.body.removeChild(document.getElementById(id));\r\n    });\r\n  }\r\n};\r\n/**\r\n *\r\n * @param {{w_text:String;w_options:Object}} options\r\n * w_text:[\"zzzz\",\"xxx\"]\r\n * w_options：{\r\n *    // 水印块宽度\r\n      w_width: 240,\r\n      // 水印块高度\r\n      w_height: 140,\r\n      // 水印区域top距离\r\n      w_top: \"0px\",\r\n      // 水印区域left距离\r\n      w_left: \"0px\",\r\n      // 旋转角度\r\n      w_rotateDeg: 25,\r\n      // 字体大小、风格\r\n      w_font: \"1.2rem Vedana\",\r\n      // 字体颜色 rgb | 16进制字符串\r\n      w_color: \"#666\",\r\n      // 透明度\r\n      w_opacity: \"0.1\",\r\n      // 层级\r\n      w_zIndex: \"100000\",\r\n * }\r\n */\r\nWatermark.loadWatermark = (options) => {\r\n  let _options = {};\r\n  let _w_texts = options.w_texts;\r\n  if (\r\n    options.w_options &&\r\n    Object.prototype.toString.call(options.w_options) === \"[object Object]\"\r\n  ) {\r\n    _options = Object.assign({}, w_options, options.w_options);\r\n  } else {\r\n    _options = w_options;\r\n  }\r\n\r\n  let id = WaterMarkDomId;\r\n  if (document.getElementById(id) !== null) {\r\n    document.body.removeChild(document.getElementById(id));\r\n  }\r\n\r\n  let canvas = document.createElement(\"canvas\");\r\n  canvas.width = _options.w_width;\r\n  canvas.height = _options.w_height;\r\n  let ctx = canvas.getContext(\"2d\");\r\n  ctx.rotate(-((_options.w_rotateDeg * Math.PI) / 180)); // 水印旋转角度\r\n  ctx.font = _options.w_font;\r\n  ctx.fillStyle = _options.w_color;\r\n  ctx.textAlign = \"center\";\r\n  ctx.textBaseline = \"Middle\";\r\n  // 水印在画布的位置x，y轴\r\n  if (\r\n    options.w_texts &&\r\n    Object.prototype.toString.call(options.w_texts) === \"[object Array]\"\r\n  ) {\r\n    for (let i = 0; i < _w_texts.length; i++) {\r\n      const element = _w_texts[i];\r\n      ctx.fillText(element, canvas.width / 5, canvas.height / 1.4 + i * 30);\r\n    }\r\n  }\r\n\r\n  var div = document.createElement(\"div\");\r\n  div.id = id;\r\n  div.className = \"wm-complete\";\r\n  div.style.pointerEvents = \"none\";\r\n  div.style.top = _options.w_top;\r\n  div.style.left = _options.w_left;\r\n  div.style.opacity = _options.w_opacity;\r\n  div.style.position = \"fixed\";\r\n  div.style.zIndex = _options.w_zIndex;\r\n  div.style.width = \"100%\";\r\n  div.style.height = \"100%\";\r\n  div.style.background = \"url(\" + canvas.toDataURL() + \") left top repeat\";\r\n  document.body.appendChild(div);\r\n\r\n  queueMicrotask(() => {\r\n    Watermark.observeDomChange(div, options);\r\n  });\r\n  return id;\r\n};\r\nWatermark.observeDomChange = (waterMarkDom, options) => {\r\n  // 选择需要观察变动的节点\r\n  const targetNode = document.querySelector(\"body\");\r\n  // 观察器的配置（需要观察什么变动）\r\n  const config = { attributes: true, childList: true, subtree: true };\r\n\r\n  // 当观察到变动时执行的回调函数\r\n  const callback = function (mutationsList, observer) {\r\n    for (let mutation of mutationsList) {\r\n      // type：观察的变动类型（attribute、characterData或者childList）。\r\n      // target：发生变动的DOM节点。\r\n      // addedNodes：新增的DOM节点。\r\n      // removedNodes：删除的DOM节点。\r\n      // previousSibling：前一个同级节点，如果没有则返回null。\r\n      // nextSibling：下一个同级节点，如果没有则返回null。\r\n      // attributeName：发生变动的属性。如果设置了attributeFilter，则只返回预先指定的属性。\r\n      // 原文链接：https://blog.csdn.net/qq_35385241/article/details/121989261\r\n      if (mutation.target === waterMarkDom) {\r\n        mutation.target.remove();\r\n        Watermark.loadWatermark(options);\r\n        observer.disconnect();\r\n      }\r\n      if (\r\n        mutation.removedNodes.length &&\r\n        mutation.removedNodes[0] === waterMarkDom\r\n      ) {\r\n        // window.alert('非法操作！！！')\r\n        Watermark.loadWatermark(options);\r\n        // 停止观察\r\n        observer.disconnect();\r\n      }\r\n    }\r\n  };\r\n  Watermark.Observer = new MutationObserver(callback);\r\n  Watermark.Observer.observe(targetNode, config);\r\n};\r\n\r\nexport default Watermark;\r\n"],"names":["root","factory","exports","module","define","amd","this","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Watermark","WaterMarkDomId","w_options","w_width","w_height","w_top","w_left","w_rotateDeg","w_font","w_color","w_opacity","w_zIndex","setWaterMark","options","id","loadWatermark","document","getElementById","removeWatermark","queueMicrotask","body","removeChild","_options","_w_texts","w_texts","toString","assign","canvas","createElement","width","height","ctx","getContext","rotate","Math","PI","font","fillStyle","textAlign","textBaseline","i","length","element","fillText","div","className","style","pointerEvents","top","left","opacity","position","zIndex","background","toDataURL","appendChild","observeDomChange","waterMarkDom","targetNode","querySelector","Observer","MutationObserver","mutationsList","observer","mutation","target","remove","disconnect","removedNodes","observe","attributes","childList","subtree"],"sourceRoot":""}